\chapter{}

\rmk{1} We follow the convention that the derivative with respect to a vector is the transpose of the gradient, the latter being a row vector. Wherever present, the acronym CRLB stands for “Cramer-Rao lower bound”. 

\begin{ex} \label{ex:5.1}
    For an underlying parametric family $\{f(x|\theta)\}_{\theta\in\Theta}$, let $\theta=H(\xi)$ be a reparametrization, where $H(\cdot)$ is differentiable and injective in a vicinity of $\xi$. Show that 
    \[
        I(\xi)=I(H(\xi))[H'(\xi)]^2. 
    \]
    \emph{Hint:} since\[
        I(\xi)=\mathbb{E}\left(\frac{\pder}{\pder \xi}\log f(x|H(\xi))\right)^2, 
    \]
    you can use the chain rule. 
\end{ex}

\begin{solution}
    \[
        \begin{aligned}
            I(\xi)&=\mathbb{E}\left(\frac{\pder \log f(x|H(\xi))}{\pder \xi}\right)^2\\
            &=\mathbb{E}\left(\frac{\pder \log f(x|H(\xi))}{\pder H(\xi)}\cdot\frac{\pder H(\xi)}{\pder \xi}\right)^2\\
            &=\mathbb{E}\left[\left(\frac{\pder \log f(x|H(\xi))}{\pder H(\xi)}\right)^2\cdot\left(\frac{\pder H(\xi)}{\pder \xi}\right)^2\right]\\
            &=\mathbb{E}\left(\frac{\pder \log f(x|H(\xi))}{\pder H(\xi)}\right)^2\cdot\left(\frac{\pder H(\xi)}{\pder \xi}\right)^2\\
            &=I(H(\xi))[H'(\xi)]^2. 
        \end{aligned}
    \]
\end{solution}

\begin{ex} \label{ex:5.2}
    In this problem, we finish a proof we started in class. Consider the following setting. 
    \begin{enumerate}[(i)]
        \item $\mathcal{P}=\{\mathbb{P}_\theta\}_{\theta\in\Theta}$, 1-dimensional exponential family generated by $(T,h)$, $\mathbf{X}\sim \mathcal{P}$, i.e., 
        \[
            f(\mathbf{x|\theta})=h(\mathbf{x})\exp\left(H(\theta)T(\mathbf{x})-B(\theta)\right); 
        \]
        \item $\tau(\theta):=\mathbb{E}_\theta T(\mathbf{X})$, $\eta=H(\theta)\in\mathcal{E}$; 
        \item the parameter functions $\theta\mapsto B(\theta), \tau(\theta), H(\theta)$ are, respectively, $C^1, C^1$ and $C^2$ in a
        vicinity of the true parameter value $\theta$ and satisfy $|\tau'(\theta)H'(\theta)H''(\theta)|>0$; 
        \item $\Theta$ is open in $\mathbb{R}$. 
    \end{enumerate}
    \begin{enumerate}[(a)]
        \item Prove that
        \[
        \tau(\theta):=\mathbb{E}_{\theta} T(\mathbf{X})=\frac{B^{\prime}(\theta)}{H^{\prime}(\theta)}, \quad \operatorname{Var}_{\theta} T(\mathbf{X})=\frac{B^{\prime \prime}(\theta)}{\left(H^{\prime}(\theta)\right)^{2}}-\frac{\eta^{\prime \prime}(\theta) B^{\prime}(\theta)}{\left(H^{\prime}(\theta)\right)^{3}}=\frac{B^{\prime \prime}(\theta)-\eta^{\prime \prime}(\theta) \tau(\theta)}{\left(\eta^{\prime}(\theta)\right)^{2}}
        \]
        You may assume that
        \[
            \frac{\partial}{\partial \theta} \int_{\mathbb{R}} f(\mathbf{x} \mid \theta) G(d \mathbf{x})=\int_{\mathbb{R}} \frac{\partial}{\partial \theta} f(\mathbf{x} \mid \theta) G(d \mathbf{x}), 
        \]
        \[
            \frac{\partial^{2}}{\partial \theta^{2}} \int_{\mathbb{R}} f(\mathbf{x} \mid \theta) G(d \mathbf{x})=\int_{\mathbb{R}} \frac{\partial^{2}}{\partial \theta^{2}} f(\mathbf{x} \mid \theta) G(d \mathbf{x}). 
        \]
        \item Conclude that \(Var_{\theta} T(\mathbf{X})\) attains the CRLB, i.e.,
        \[
        \operatorname{Var}_{\theta} T(\mathbf{X})=\frac{1}{I(\tau(\theta))}
        \]
        Also conclude that, almost surely, it is the only unbiased estimator of \(\tau(\theta)\) to do so.
    \end{enumerate}
\end{ex}

\begin{solution}
    \begin{enumerate}[(a)]
        \item \label{ex:5.2.a} Let $\theta=H^{-1}(\eta)$, then 
        \[
            \mathbb{E}_\theta T(X) = A'(\eta) =\frac{\pder B(H^{-1}(\eta))}{\pder \eta}=B'(H^{-1}(\eta))\frac{1}{H'(\theta)}=\frac{B'(\theta)}{H'(\theta)}. 
        \]
        \[
            \begin{aligned}
                Var_\theta T(X)&=A''(\eta)\\
                &=\left(\frac{B'(H^{-1}(\eta))}{H'(H^{-1}(\eta))}\right)'\\
                &=\frac{B''(H^{-1}(\eta))(H^{-1}(\eta))'}{H'(H^{-1}(\eta))}-B'(H^{-1}(\eta))\frac{B'(H^{-1}(\eta))H''(H^{-1}(\eta))(H^{-1}(\eta))'}{\left(H'(H^{-1}(\eta))\right)^2}\\
                &=\frac{B''(\theta)}{(H'(\theta))^2}-\frac{B'(\theta)H''(\theta)}{(H'(\theta))^3}\\
                &=\frac{B''(\theta)-\eta''(\theta)\tau(\theta)}{(\eta'(\theta))^2}. 
            \end{aligned}
        \]
        \item \[
            I(\theta)=Var_\theta\left(\frac{f'(\mathbf{x|\theta})}{f(\mathbf{x|\theta})}\right)=Var_{\theta}(\eta'(\theta)T(\mathbf{x})-B'(\theta))=Var_\theta(T(\mathbf{x}))(\eta'(\theta))^2. 
        \]
        Then from Exercise \ref{ex:5.1}, 
        \[
            I(\tau(\theta))=\frac{I(\theta)}{(\tau'(\theta))^2}=\left[\frac{\eta'(\theta)}{\tau'(\theta)}\right]^2Var_\theta T(\mathbf{x})
        \]
        And from Exercise \ref{ex:5.2} \ref{ex:5.2.a},
        \[
            Var_\theta T(X)=\frac{B''(\theta)-\eta''(\theta)\tau(\theta)}{(\eta'(\theta))^2}, \qquad \tau(\theta)=\frac{B'(\theta)}{\eta'(\theta)}. 
        \]
        \[
            \tau'(\theta)=\frac{B''(\theta)-\tau(\theta)\eta''(\theta)}{\eta'(\theta)}, 
        \]
        and \[
            \frac{\tau'(\theta)}{\eta'(\theta)}=Var_\theta T(X).
        \]
        So, 
        \[
            I(\tau(\theta))=\left[\frac{\eta'(\theta)}{\tau'(\theta)}\right]^2Var_\theta T(\mathbf{x})=\frac{\tau'(\theta)}{\eta'(\theta)}=\frac{1}{Var_\theta T(\mathbf{x})}. 
        \]
    \end{enumerate}
\end{solution}

\begin{ex}
    Complete the following table: 
    \begin{center}
        \begin{tabular}{ccc}
            \hline
            distribution & parameter $\tau(\theta)$ & $I(\tau(\theta))$ \\ \hline
            $\mathcal{N}(\mu, \sigma^2)$ & $\mu$ &  \\
            $\mathcal{N}(\mu, \sigma^2)$ & $\sigma^2$ &  \\
            $B(n,p)$ & $p$ &  \\
            $Poi(\lambda)$ & $\lambda$ &  \\
            $\Gamma(\alpha, \lambda)$ & $\beta=\lambda^{-1}$ &  \\
            \hline
            \end{tabular}
    \end{center}
\end{ex}